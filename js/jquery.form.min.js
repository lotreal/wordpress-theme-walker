/*
 * Compressed by JSA(www.xidea.org)
 */
(function($){$.fn.ajaxSubmit=function(options){if(typeof options=="function")options={success:options};options=$.extend({url:this.attr("action")||window.location.toString(),type:this.attr("method")||"GET"},options||{});var veto={};$.event.trigger("form.pre.serialize",[this,options,veto]);if(veto.veto)return this;var a=this.formToArray(options.semantic);if(options.data)for(var n in options.data)a.push({name:n,value:options.data[n]});if(options.beforeSubmit&&options.beforeSubmit(a,this,options)===false)return this;$.event.trigger("form.submit.validate",[a,this,options,veto]);if(veto.veto)return this;var q=$.param(a);if(options.type.toUpperCase()=="GET"){options.url+=(options.url.indexOf("?")>=0?"&":"?")+q;options.data=null}else options.data=q;var $form=this,callbacks=[];if(options.resetForm)callbacks.push(function(){$form.resetForm()});if(options.clearForm)callbacks.push(function(){$form.clearForm()});if(!options.dataType&&options.target){var oldSuccess=options.success||function(){};callbacks.push(function(A){if(this.evalScripts)$(options.target).attr("innerHTML",A).evalScripts().each(oldSuccess,arguments);else $(options.target).html(A).each(oldSuccess,arguments)})}else if(options.success)callbacks.push(options.success);options.success=function(C,B){for(var D=0,A=callbacks.length;D<A;D++)callbacks[D](C,B,$form)};var files=$("input:file",this).fieldValue(),found=false;for(var j=0;j<files.length;j++)if(files[j])found=true;if(options.iframe||found){if($.browser.safari&&options.closeKeepAlive)$.get(options.closeKeepAlive,fileUpload);else fileUpload()}else $.ajax(options);$.event.trigger("form.submit.notify",[this,options]);return this;function fileUpload(){var form=$form[0],opts=$.extend({},$.ajaxSettings,options),id="jqFormIO"+$.fn.ajaxSubmit.counter++,$io=$("<iframe id=\""+id+"\" name=\""+id+"\" />"),io=$io[0],op8=$.browser.opera&&window.opera.version()<9;if($.browser.msie||op8)io.src="javascript:false;document.write(\"\");";$io.css({position:"absolute",top:"-1000px",left:"-1000px"});var xhr={responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){}},g=opts.global;if(g&&!$.active++)$.event.trigger("ajaxStart");if(g)$.event.trigger("ajaxSend",[xhr,opts]);var cbInvoked=0,timedOut=0;setTimeout(function(){var A=form.encoding?"encoding":"enctype",B=$form.attr("target");$form.attr({target:id,method:"POST",action:opts.url});form[A]="multipart/form-data";if(opts.timeout)setTimeout(function(){timedOut=true;cb()},opts.timeout);$io.appendTo("body");io.attachEvent?io.attachEvent("onload",cb):io.addEventListener("load",cb,false);form.submit();$form.attr("target",B)},10);function cb(){if(cbInvoked++)return;io.detachEvent?io.detachEvent("onload",cb):io.removeEventListener("load",cb,false);var ok=true;try{if(timedOut)throw"timeout";var data,doc;doc=io.contentWindow?io.contentWindow.document:io.contentDocument?io.contentDocument:io.document;xhr.responseText=doc.body?doc.body.innerHTML:null;xhr.responseXML=doc.XMLDocument?doc.XMLDocument:doc;if(opts.dataType=="json"||opts.dataType=="script"){var ta=doc.getElementsByTagName("textarea")[0];data=ta?ta.value:xhr.responseText;if(opts.dataType=="json")eval("data = "+data);else $.globalEval(data)}else if(opts.dataType=="xml"){data=xhr.responseXML;if(!data&&xhr.responseText!=null)data=toXml(xhr.responseText)}else data=xhr.responseText}catch(e){ok=false;$.handleError(opts,xhr,"error",e)}if(ok){opts.success(data,"success");if(g)$.event.trigger("ajaxSuccess",[xhr,opts])}if(g)$.event.trigger("ajaxComplete",[xhr,opts]);if(g&&!--$.active)$.event.trigger("ajaxStop");if(opts.complete)opts.complete(xhr,ok?"success":"error");setTimeout(function(){$io.remove();xhr.responseXML=null},100)}function toXml(A,B){if(window.ActiveXObject){B=new ActiveXObject("Microsoft.XMLDOM");B.async="false";B.loadXML(A)}else B=(new DOMParser()).parseFromString(A,"text/xml");return(B&&B.documentElement&&B.documentElement.tagName!="parsererror")?B:null}}};$.fn.ajaxSubmit.counter=0;$.fn.ajaxForm=function(A){return this.ajaxFormUnbind().submit(submitHandler).each(function(){this.formPluginId=$.fn.ajaxForm.counter++;$.fn.ajaxForm.optionHash[this.formPluginId]=A;$(":submit,input:image",this).click(clickHandler)})};$.fn.ajaxForm.counter=1;$.fn.ajaxForm.optionHash={};function clickHandler(A){var B=this.form;B.clk=this;if(this.type=="image")if(A.offsetX!=undefined){B.clk_x=A.offsetX;B.clk_y=A.offsetY}else if(typeof $.fn.offset=="function"){var C=$(this).offset();B.clk_x=A.pageX-C.left;B.clk_y=A.pageY-C.top}else{B.clk_x=A.pageX-this.offsetLeft;B.clk_y=A.pageY-this.offsetTop}setTimeout(function(){B.clk=B.clk_x=B.clk_y=null},10)}function submitHandler(){var A=this.formPluginId,B=$.fn.ajaxForm.optionHash[A];$(this).ajaxSubmit(B);return false}$.fn.ajaxFormUnbind=function(){this.unbind("submit",submitHandler);return this.each(function(){$(":submit,input:image",this).unbind("click",clickHandler)})};$.fn.formToArray=function(E){var C=[];if(this.length==0)return C;var B=this[0],G=E?B.getElementsByTagName("*"):B.elements;if(!G)return C;for(var H=0,A=G.length;H<A;H++){var L=G[H],D=L.name;if(!D)continue;if(E&&B.clk&&L.type=="image"){if(!L.disabled&&B.clk==L)C.push({name:D+".x",value:B.clk_x},{name:D+".y",value:B.clk_y});continue}var I=$.fieldValue(L,true);if(I&&I.constructor==Array){for(var F=0,J=I.length;F<J;F++)C.push({name:D,value:I[F]})}else if(I!==null&&typeof I!="undefined")C.push({name:D,value:I})}if(!E&&B.clk){var M=B.getElementsByTagName("input");for(H=0,A=M.length;H<A;H++){var K=M[H],D=K.name;if(D&&!K.disabled&&K.type=="image"&&B.clk==K)C.push({name:D+".x",value:B.clk_x},{name:D+".y",value:B.clk_y})}}return C};$.fn.formSerialize=function(A){return $.param(this.formToArray(A))};$.fn.fieldSerialize=function(B){var A=[];this.each(function(){var E=this.name;if(!E)return;var C=$.fieldValue(this,B);if(C&&C.constructor==Array){for(var F=0,D=C.length;F<D;F++)A.push({name:E,value:C[F]})}else if(C!==null&&typeof C!="undefined")A.push({name:this.name,value:C})});return $.param(A)};$.fn.fieldValue=function(E){for(var A=[],F=0,C=this.length;F<C;F++){var D=this[F],B=$.fieldValue(D,E);if(B===null||typeof B=="undefined"||(B.constructor==Array&&!B.length))continue;B.constructor==Array?$.merge(A,B):A.push(B)}return A};$.fieldValue=function(K,L){var G=K.name,J=K.type,D=K.tagName.toLowerCase();if(typeof L=="undefined")L=true;if(L&&(!G||K.disabled||J=="reset"||J=="button"||(J=="checkbox"||J=="radio")&&!K.checked||(J=="submit"||J=="image")&&K.form&&K.form.clk!=K||D=="select"&&K.selectedIndex==-1))return null;if(D=="select"){var A=K.selectedIndex;if(A<0)return null;var E=[],M=K.options,F=(J=="select-one"),B=(F?A+1:M.length);for(var H=(F?A:0);H<B;H++){var C=M[H];if(C.selected){var I=$.browser.msie&&!(C.attributes["value"].specified)?C.text:C.value;if(F)return I;E.push(I)}}return E}return K.value};$.fn.clearForm=function(){return this.each(function(){$("input,select,textarea",this).clearFields()})};$.fn.clearFields=$.fn.clearInputs=function(){return this.each(function(){var A=this.type,B=this.tagName.toLowerCase();if(A=="text"||A=="password"||B=="textarea")this.value="";else if(A=="checkbox"||A=="radio")this.checked=false;else if(B=="select")this.selectedIndex=-1})};$.fn.resetForm=function(){return this.each(function(){if(typeof this.reset=="function"||(typeof this.reset=="object"&&!this.reset.nodeType))this.reset()})};$.fn.enable=function(A){if(A==undefined)A=true;return this.each(function(){this.disabled=!A})};$.fn.select=function(A){if(A==undefined)A=true;return this.each(function(){var B=this.type;if(B=="checkbox"||B=="radio")this.checked=A;else if(this.tagName.toLowerCase()=="option"){var C=$(this).parent("select");if(A&&C[0]&&C[0].type=="select-one")C.find("option").select(false);this.selected=A}})}})(jQuery)